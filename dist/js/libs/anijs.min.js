"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t){"object"==("undefined"==typeof module?"undefined":_typeof(module))&&"object"==_typeof(module.exports)?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("AniJS-RWWD");return t(e)}:t(e)}("undefined"!=typeof window?window:void 0,function(f,e){var t=function(u){var a="data-anijs",n="default",l=["do","after","before","to"],i="(\\s+|^)",o="(\\s+|$)",r="animationend",s="transitionend";u={rootDOMTravelScope:{},notifierCollection:{},init:function(){v._t={};var e=v._a();u.registerHelper(n,e),v._u=n,u.rootDOMTravelScope=document,u.Parser=v.Parser,v._v=v._p(),v._w=""},setDOMRootTravelScope:function(e){var t,n=document;try{"document"===e?t=n:(t=n.querySelector(e))||(t=n)}catch(e){t=n}u.rootDOMTravelScope=t},run:function(){var e,t={};u.purgeAll(),u.notifierCollection={};for(var n,r=(e=v._o(u.rootDOMTravelScope)).length,i=0;i<r;i++)n=e[i],t=v._n(n.getAttribute(a)),v._c(n,t);var o=u.getNotifier("AniJSNotifier");o&&o.dispatchEvent("onRunFinished")},createAnimation:function(e,t){var n=t||"";v._c(n,e)},getHelper:function(e){var t=v._t;return t[e]||t[n]},registerHelper:function(e,t){v._t[e]=t},purge:function(e){if(e&&""!==e&&" "!==e)for(var t=document.querySelectorAll(e),n=t.length,r=0;r<n;r++)u.EventSystem.purgeEventTarget(t[r])},purgeAll:function(){u.EventSystem.purgeAll()},purgeEventTarget:function(e){u.EventSystem.purgeEventTarget(e)},setClassNamesWhenAnim:function(e){v._w=" "+e},createNotifier:function(){return u.EventSystem.createEventTarget()},registerNotifier:function(e){var t=u.notifierCollection;return e.id&&e.value&&u.EventSystem.isEventTarget(e.value)?(t[e.id]=e.value,1):""},getNotifier:function(e){return u.notifierCollection[e]}};var v={_a:function(){return{removeAnim:function(e,t){e.target&&e.type&&t.nodeHelper.removeClass(e.target,t.behavior)},holdAnimClass:function(){},fireOnce:function(e,t){t.eventSystem.removeEventListenerHelper(t.eventTarget,t.event.type,t.listener)},emit:function(e,t,n){var r=n[0]||null,i="";if(null!==r){1<(r=r.split(".")).length?(i=r[0],r=r[1]):(i="",r=r[0]);var o=u.getNotifier(i)||null;null!==o&&o.dispatchEvent(r)}t.hasRunned||t.run()}}},_b:function(){return new Parser},_c:function(e,t){for(var n,r,i,o,a=t.length,l=0;l<a;l++)i=(n=t[l]).after,r=n.before,o=n.behavior,i&&(n.after=v.Parser.parseDoDefinition(i)),r&&(n.before=v.Parser.parseDoDefinition(r)),o&&(n.behavior=v.Parser.parseDoDefinition(o)),v._d(e,n)},_d:function(l,s){var f,e=v._e(s),t=v._f(l,s);if(s.after&&v.Util._x(s.after)&&(f=s.after[0]),""!==e)for(var n,r=t.length,i=0;i<r;i++)if(n=t[i],u.EventSystem.isEventTarget(n)){var o=function e(t){var n=v._g(l,s,t),r=v._h(s),i=v._j(l,s),o=v._i(l,s);""!==v._w&&(v.Util._x(r)||(r+=v._w));var a={behaviorTargetList:n,nodeHelper:v.NodeHelper,animationEndEvent:v._v,behavior:r,after:o,eventSystem:u.EventSystem,eventTarget:t.currentTarget,afterFunctionName:f,dataAniJSOwner:l,listener:e,event:t,before:i};new u.AnimationContext(a).runAll(a)};u.EventSystem.addEventListenerHelper(n,e,o,!1),u.EventSystem.registerEventHandle(n,e,o)}},_e:function(e){var t=e.event||"";return t===r?t=v._p():t===s&&(t=v._q()),t},_f:function(e,t){var n,r=[e],i=u.rootDOMTravelScope;if(t.eventTarget)if(0<(n=v._notifierHelper(t.eventTarget)).length)r=n;else if("document"===t.eventTarget)r=[document];else if("window"===t.eventTarget)r=[f];else if(t.eventTarget.split)try{r=i.querySelectorAll(t.eventTarget)}catch(e){r=[]}return r},_g:function(e,t,n){var r=[e],i=u.rootDOMTravelScope,o=t.behaviorTarget;if(o)if(v.Util._x(o)){var a=this._y(e,t,o);a&&v.Util.isFunction(a[0])&&(r=a[0](n,{dataAniJSOwner:e},v._z(a)))}else if("target"===o&&n.currentTarget)r=[n.currentTarget];else{o=o.split("$").join(",");try{r=i.querySelectorAll(o)}catch(e){r=[]}}return r},_h:function(e){return this._y({},e,e.behavior)},_i:function(e,t){var n=t.after;return v.Util._x(n)?this._y(e,t,n):v._k(e,t,n)},_j:function(e,t){var n=t.before;return v.Util._x(n)?this._y(e,t,n):v._k(e,t,n)},_y:function(e,t,n){var r,i=n||"";return v.Util._x(i)&&((r=v._k(e,t,i[0]))?i[0]=r:i=i.join(" ")),i},_k:function(e,t,n){var r=n||"",i=v._l(t);if(r&&!v.Util.isFunction(r)){var o=v._t[i];r=!(!o||!v.Util.isFunction(o[r]))&&o[r]}return r},_l:function(e){return e.helper||v._u},_notifierHelper:function(e){var t=[];if(u.notifierCollection,e)if(e.id&&u.EventSystem.isEventTarget(e.value))t.push(e.value),u.registerNotifier(e);else if(e.split){notifierIDList=e.split("$");for(var n,r=notifierIDList.length,i=1;i<r;i++)if((n=notifierIDList[i])&&" "!==n){n=n.trim();var o=u.getNotifier(n);o||(o=u.EventSystem.createEventTarget(),u.registerNotifier({id:n,value:o})),t.push(o)}}return t},_z:function(e){for(var t=[],n=e.length;1<n--;)t[n-1]=e[n];return t},_n:function(e){return v.Parser.parse(e)},_o:function(e){return e.querySelectorAll("[data-anijs]")},_p:function(){var e=v._r();return[r,"oAnimationEnd",r,"webkitAnimationEnd"][e]},_q:function(){var e=v._r();return[s,"oTransitionEnd",s,"webkitTransitionEnd"][e]},_r:function(){for(var e=document.createElement("fe"),t="Animation",n=["animation","O"+t,"Moz"+t,"webkit"+t],r=0;r<n.length;r++)if(void 0!==e.style[n[r]])return r}};return u.AnimationContext=function(e){var s=this;s.init=function(e){s.behaviorTargetList=e.behaviorTargetList||[],s.nodeHelper=e.nodeHelper,s.animationEndEvent=e.animationEndEvent,s.behavior=e.behavior,s.after=e.after,s.eventSystem=e.eventSystem,s.eventTarget=e.eventTarget,s.afterFunctionName=e.afterFunctionName,s.dataAniJSOwner=e.dataAniJSOwner,s.listener=e.listener,s.event=e.event,s.before=e.before},s.doDefaultAction=function(e,t){var n,r=s,i=r.nodeHelper,o=r.animationEndEvent,a=r.after,l=r.afterFunctionName;r.eventSystem.addEventListenerHelper(e,o,function(e){e.stopPropagation(),r.eventSystem.removeEventListenerHelper(e.target,e.type,arguments.callee),a&&(v.Util.isFunction(a)?a(e,s):v.Util._x(a)&&a[0](e,s,v._z(a)))}),"holdAnimClass"!==l&&"$holdAnimClass"!==l&&((n=e._ajLastBehavior)&&i.removeClass(e,n),e._ajLastBehavior=t),e.offsetWidth=e.offsetWidth,i.addClass(e,t)},s.doFunctionAction=function(e,t){var n=s.after,r={target:e};t[0](r,s,v._z(t)),v.Util.isFunction(n)?n(r,s):v.Util._x(n)&&n[0](r,s,v._z(n))},s.runAll=function(){for(var e,t,n=s,r=n.behaviorTargetList,i=r.length,o=(n.behavior,0),a=n.before,l=s.event;o<i;o++)t={behaviorTargetList:[r[o]],nodeHelper:s.nodeHelper,animationEndEvent:s.animationEndEvent,behavior:s.behavior,after:s.after,eventSystem:s.eventSystem,eventTarget:s.eventTarget,afterFunctionName:s.afterFunctionName,dataAniJSOwner:s.dataAniJSOwner,listener:s.listener,event:l},e=new u.AnimationContext(t),a?v.Util.isFunction(a)?a(l,e):v.Util._x(a)&&a[0](l,e,v._z(a)):e.run()},s.run=function(){var e=s,t=e.behavior,n=e.behaviorTargetList[0];s.hasRunned=1,v.Util._x(t)?e.doFunctionAction(n,t):e.doDefaultAction(n,t)},s.init(e)},v.Parser={parse:function(e){return this.parseDeclaration(e)},parseDeclaration:function(e){for(var t,n,r=[],i=(t=e.split(";")).length,o=0;o<i;o++)n=this.parseSentence(t[o]),r.push(n);return r},parseSentence:function(e){for(var t,n,r={},i=(t=e.split(",")).length,o=0;o<i;o++)r[(n=this.parseDefinition(t[o])).key]=n.value;return r},parseDefinition:function(e){var t,n,r,i={},o=["behavior","after","before","behaviorTarget"];if(1<(t=e.split(":")).length){if(n=t[0].trim(),2<t.length?r=(r=(r=t.slice(1)).join(":")).trim():r=t[1].trim(),i.value=r,"if"===n)n="event";else if("on"===n)n="eventTarget";else for(var a=l.length-1;0<=a;a--)n===l[a]&&("after"!==(n=o[a])&&"before"!==n||"$"===r[0]||(r="$"+r),r=this.parseDoDefinition(r));i.key=n,i.value=r}return i},parseDoDefinition:function(e){var t=/^\$(\w+)\s*/g.exec(e),n="",r=1;if(null!==t){n=t[1],doDefinitionArray=e.split(t[0])[1],doDefinitionArray=null!==doDefinitionArray?doDefinitionArray.split("|"):[],(e=[])[0]=n;for(var i=0;i<doDefinitionArray.length;i++)""!==doDefinitionArray[i]&&(e[r++]=doDefinitionArray[i].trim());return e}return e}},v.NodeHelper={addClass:function(e,t){t instanceof Array||(t=t.split(" "));for(var n=0,r=t.length;n<r;++n)t[n]&&!new RegExp(i+t[n]+o).test(e.className)&&(e.className=""===e.className?t[n]:e.className.trim()+" "+t[n])},removeClass:function(e,t){t instanceof Array||(t=t.split(" "));for(var n=0,r=t.length;n<r;++n)e.className=e.className.replace(new RegExp(i+t[n]+o)," ").trim()},hasClass:function(e,t){return t&&new RegExp(i+t+o).test(e.className)}},v.Util={isFunction:function(e){return!!(e&&e.constructor&&e.call&&e.apply)},_x:function(e){return Array.isArray(e)}},u.EventSystem={eventCollection:{},eventIdCounter:0,isEventTarget:function(e){return e.addEventListener?1:0},createEventTarget:function(){return new u.EventTarget},addEventListenerHelper:function(e,t,n){e.addEventListener(t,n,!1)},removeEventListenerHelper:function(e,t,n){e&&e.removeEventListener(t,n)},purgeAll:function(){for(var e,t,n=this.eventCollection,r=Object.keys(n),i=r.length,o=0;o<i;o++)(t=n[e=r[o]])&&t.handleCollection&&0<t.handleCollection.length&&this.purgeEventTarget(t.handleCollection[0].element),delete n[e]},purgeAllNodes:function(e){var t=e.querySelectorAll("*");size=t.length;for(var n=size-1;0<=n;n--)this.purgeEventTarget(t[n])},purgeEventTarget:function(e){var t,n=e._aniJSEventID;if(n){for(var r,i=(t=this.eventCollection[n].handleCollection).length,o=0;o<i;o++)r=t[o],this.removeEventListenerHelper(e,r.eventType,r.listener);this.eventCollection[n]=e._aniJSEventID=null,delete this.eventCollection[n],delete e._aniJSEventID}},registerEventHandle:function(e,t,n){var r=e._aniJSEventID,i=this.eventCollection,o={eventType:t,listener:n,element:e};if(r)i[r].handleCollection.push(o);else{var a={handleCollection:[o]};i[++this.eventIdCounter]=a,e._aniJSEventID=this.eventIdCounter}}},u.EventTarget=function(){this._listeners={}},u.EventTarget.prototype={constructor:u.EventTarget,addEventListener:function(e,t){void 0===this._listeners[e]&&(this._listeners[e]=[]),this._listeners[e].push(t)},dispatchEvent:function(e){if("string"==typeof e&&(e={type:e}),e.target||(e.target=this),!e.type)throw new Error("error");if(this._listeners[e.type]instanceof Array)for(var t=this._listeners[e.type],n=0,r=t.length;n<r;n++)t[n].call(this,e)},removeEventListener:function(e,t){if(this._listeners[e]instanceof Array)for(var n=this._listeners[e],r=0,i=n.length;r<i;r++)if(n[r]===t){n.splice(r,1);break}}},u}(t||{});return t.init(),t.run(),"function"==typeof define&&define.amd&&define("anijs",[],function(){return t}),void 0===e&&(f.AniJS=t),t});